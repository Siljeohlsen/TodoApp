<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    
    <title>Account Settings</title>
</head>
<body>

    <!----------- HTML-elements -------------->
    <link rel="stylesheet" href="css.css">
    
    <button id="btnHome">Back to Home</button> <br>
    <h1> Account settings </h1>
    
    <button id="btnDeleteuser">Delete your user </button> 
    <h3 id="deleteUpdateStatus"></h3>
    
    <!------------- JavaScript --------------->
    <script>

    let inpUsername = document.getElementById('inpUsername');
    let inpPassword = document.getElementById('inpPassword');

    let btnHome = document.getElementById('btnHome');
    let btnChangepassword = document.getElementById('btnChangepassword');

    let btnDeleteuser = document.getElementById('btnDeleteuser');
    let deleteUpdateStatus = document.getElementById('deleteUpdateStatus')

    // Back to home button  -----------------------
    btnHome.addEventListener('click', async function(evt){
    window.location.href = "index.html";
    
    });

    // Delete a user -----------------------
    // Sletter brukeren når man trykker på knappen. 
    btnDeleteuser.addEventListener('click', async function(evt){

        alert("Are you sure you want to delete your account?"); 
        // Legger inn en alert, et nytt vindu som dukker opp når man trykker på knappen, 
        // denne gjør at man må bekrefte at funksjonen som sletter brukeren blir kjørt. 

        if(confirm){
               
       let url = "/users/delete"; // url'en som forteller hvilken funksjon som kjøres i users.js

        let token = localStorage.getItem("token"); // henter token fra brukeren som er innlogget i localstorage. 
    
        let cfg = {
            method: "DELETE",
            headers: {
                "content-type":"application/json",    // hvilken HTTP-metode som brukes. 
                "authorization": token
            }
        }
        try {
            let response = await fetch(url, cfg);
            let data = await response.json();

            if (response.status != 200) {
               deleteUpdateStatus.innerHTML = data.msg; // gir detaljert feilmelding på hva som eventuelt går riktig eller galt. 
                                                   // data.msg lages i users.js. deleteUpdateStatus er en <h3> i denne .html-filen. 
            }else{
                deleteUpdateStatus.innerHTML = data.msg;
            }

        
        }
        catch(error) {
            console.log(error);
        }
      } 
    }); 

    </script>

</body>

</html>